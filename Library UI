--[[ 
Demon Hub UI Library - Enhanced Edition v2.0
âœ¨ Modern animated loading screen
âœ¨ UI override system (no duplicates)
âœ¨ Fixed mobile dragging performance
âœ¨ Fixed resize bugs
âœ¨ Expanded color picker
âœ¨ Better fluidity and responsiveness

Original Interface: Trix#2794 & Julman#1234 
Enhanced by Gemini & Claude
--]] 

---@diagnostic disable: redefined-local, undefined-global, unused-local, param-type-mismatch, redundant-value, lowercase-global, undefined-field 

-- ðŸ”¥ UI OVERRIDE SYSTEM - Delete old UI before creating new one
pcall(function()
    for _, gui in ipairs(game:GetService("CoreGui"):GetChildren()) do
        if gui.Name:match("^lib_") or gui.Name == "DemonHubLoader" then
            gui:Destroy()
        end
    end
end)

-- âœ¨ MODERN LOADING SCREEN
pcall(function() 
    local TweenService = game:GetService("TweenService")
    local loader = Instance.new("ScreenGui") 
    loader.Name = "DemonHubLoader" 
    loader.ZIndexBehavior = Enum.ZIndexBehavior.Sibling 
    loader.Parent = game:GetService("CoreGui") 

    local bg = Instance.new("Frame", loader) 
    bg.Size = UDim2.new(1, 0, 1, 0) 
    bg.BackgroundColor3 = Color3.fromRGB(8, 8, 12) 
    bg.BorderSizePixel = 0 
    bg.ZIndex = 10 

    -- Modern animated gradient
    local gradient = Instance.new("UIGradient", bg) 
    gradient.Color = ColorSequence.new({ 
        ColorSequenceKeypoint.new(0, Color3.fromRGB(12, 8, 18)), 
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(22, 12, 28)), 
        ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 8, 20)) 
    }) 
    gradient.Rotation = 45 
    
    -- Animate gradient rotation
    spawn(function()
        while loader.Parent do
            for i = 45, 405, 2 do
                if not loader.Parent then break end
                gradient.Rotation = i
                task.wait(0.03)
            end
        end
    end)

    -- Multiple animated glows for depth
    for i = 1, 3 do
        local glow = Instance.new("Frame", bg) 
        glow.Size = UDim2.new(0, 200 + i * 50, 0, 200 + i * 50) 
        glow.Position = UDim2.new(0.5, -(100 + i * 25), 0.5, -(100 + i * 25)) 
        glow.BackgroundColor3 = Color3.fromRGB(255, 60 + i * 10, 60 + i * 10) 
        glow.BackgroundTransparency = 0.92 + i * 0.02
        glow.BorderSizePixel = 0 
        glow.ZIndex = 11 
        Instance.new("UICorner", glow).CornerRadius = UDim.new(1, 0) 
        
        TweenService:Create(glow, TweenInfo.new(2.5 - i * 0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), { 
            BackgroundTransparency = 0.98, 
            Size = UDim2.new(0, 300 + i * 80, 0, 300 + i * 80), 
            Position = UDim2.new(0.5, -(150 + i * 40), 0.5, -(150 + i * 40)),
            Rotation = i % 2 == 0 and 360 or -360
        }):Play() 
    end

    -- Particle effect simulation
    for i = 1, 15 do
        local particle = Instance.new("Frame", bg)
        particle.Size = UDim2.new(0, math.random(2, 5), 0, math.random(2, 5))
        particle.Position = UDim2.new(math.random(), 0, math.random(), 0)
        particle.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
        particle.BackgroundTransparency = math.random(70, 95) / 100
        particle.BorderSizePixel = 0
        particle.ZIndex = 12
        Instance.new("UICorner", particle).CornerRadius = UDim.new(1, 0)
        
        TweenService:Create(particle, TweenInfo.new(math.random(3, 6), Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1, true), {
            Position = UDim2.new(math.random(), 0, math.random(), 0),
            BackgroundTransparency = 1
        }):Play()
    end

    local title = Instance.new("TextLabel", bg) 
    title.Size = UDim2.new(0, 550, 0, 90) 
    title.Position = UDim2.new(0.5, -275, 0.42, -45) 
    title.BackgroundTransparency = 1 
    title.Text = "DEMON HUB" 
    title.TextColor3 = Color3.fromRGB(255, 255, 255) 
    title.Font = Enum.Font.GothamBold 
    title.TextSize = 64 
    title.TextTransparency = 1 
    title.ZIndex = 13
    
    -- Text stroke effect
    Instance.new("UIStroke", title).Color = Color3.fromRGB(255, 70, 70)
    title.UIStroke.Thickness = 2
    title.UIStroke.Transparency = 1

    local subtitle = Instance.new("TextLabel", bg) 
    subtitle.Size = UDim2.new(0, 500, 0, 30) 
    subtitle.Position = UDim2.new(0.5, -250, 0.56, 0) 
    subtitle.BackgroundTransparency = 1 
    subtitle.Text = "Initializing Advanced Components..." 
    subtitle.TextColor3 = Color3.fromRGB(200, 200, 220) 
    subtitle.Font = Enum.Font.GothamBold 
    subtitle.TextSize = 15 
    subtitle.TextTransparency = 1 
    subtitle.ZIndex = 13 

    -- Modern loading bar container
    local loadingBarBG = Instance.new("Frame", bg)
    loadingBarBG.Size = UDim2.new(0, 380, 0, 6)
    loadingBarBG.Position = UDim2.new(0.5, -190, 0.62, 0)
    loadingBarBG.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    loadingBarBG.BorderSizePixel = 0
    loadingBarBG.BackgroundTransparency = 1
    loadingBarBG.ZIndex = 13
    Instance.new("UICorner", loadingBarBG).CornerRadius = UDim.new(1, 0)
    Instance.new("UIStroke", loadingBarBG).Color = Color3.fromRGB(60, 60, 80)
    loadingBarBG.UIStroke.Thickness = 1
    loadingBarBG.UIStroke.Transparency = 1

    local loadingBar = Instance.new("Frame", loadingBarBG)
    loadingBar.Size = UDim2.new(0, 0, 1, 0)
    loadingBar.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
    loadingBar.BorderSizePixel = 0
    loadingBar.ZIndex = 14
    Instance.new("UICorner", loadingBar).CornerRadius = UDim.new(1, 0)
    
    -- Animated gradient on loading bar
    local barGradient = Instance.new("UIGradient", loadingBar)
    barGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 50, 50)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 90, 90)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 50, 50))
    })
    
    spawn(function()
        while loader.Parent do
            for i = 0, 360, 5 do
                if not loader.Parent then break end
                barGradient.Rotation = i
                task.wait(0.02)
            end
        end
    end)

    -- Percentage text
    local percentText = Instance.new("TextLabel", bg)
    percentText.Size = UDim2.new(0, 100, 0, 30)
    percentText.Position = UDim2.new(0.5, -50, 0.665, 0)
    percentText.BackgroundTransparency = 1
    percentText.Text = "0%"
    percentText.TextColor3 = Color3.fromRGB(255, 80, 80)
    percentText.Font = Enum.Font.GothamBold
    percentText.TextSize = 16
    percentText.TextTransparency = 1
    percentText.ZIndex = 13

    -- Smooth animations
    TweenService:Create(title, TweenInfo.new(1, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {TextTransparency = 0}):Play() 
    TweenService:Create(title.UIStroke, TweenInfo.new(1, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {Transparency = 0}):Play() 
    task.wait(0.3) 
    TweenService:Create(subtitle, TweenInfo.new(0.7, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {TextTransparency = 0}):Play() 
    task.wait(0.2)
    TweenService:Create(loadingBarBG, TweenInfo.new(0.6, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
    TweenService:Create(loadingBarBG.UIStroke, TweenInfo.new(0.6, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {Transparency = 0.4}):Play()
    TweenService:Create(percentText, TweenInfo.new(0.6, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
    task.wait(0.3)
    
    -- Animated loading with percentage
    for i = 0, 100, 2 do
        local progress = i / 100
        loadingBar.Size = UDim2.new(progress, 0, 1, 0)
        percentText.Text = i .. "%"
        
        -- Update subtitle text at milestones
        if i == 25 then
            subtitle.Text = "Loading Core Systems..."
        elseif i == 50 then
            subtitle.Text = "Connecting to Services..."
        elseif i == 75 then
            subtitle.Text = "Finalizing Interface..."
        elseif i == 100 then
            subtitle.Text = "Ready!"
        end
        
        task.wait(0.015)
    end
    
    task.wait(0.4)
    
    -- Smooth fade-out
    TweenService:Create(bg, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {BackgroundTransparency = 1}):Play() 
    TweenService:Create(title, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {TextTransparency = 1}):Play() 
    TweenService:Create(title.UIStroke, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {Transparency = 1}):Play() 
    TweenService:Create(subtitle, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {TextTransparency = 1}):Play() 
    TweenService:Create(loadingBarBG, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {BackgroundTransparency = 1}):Play()
    TweenService:Create(loadingBarBG.UIStroke, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {Transparency = 1}):Play()
    TweenService:Create(percentText, TweenInfo.new(0.7, Enum.EasingStyle.Quint), {TextTransparency = 1}):Play()
    task.wait(0.7) 
    loader:Destroy() 

    local snd = 6026984224 
    local sound = Instance.new("Sound", workspace) 
    sound.SoundId = "rbxassetid://" .. snd 
    sound.Name = "Notification" 
    sound.Volume = 1 
    sound:Play() 
    sound.Ended:Connect(function() sound:Destroy() end) 
end) 

local library = (function () 
    local UserInputService = game:GetService("UserInputService") 
    local TweenService = game:GetService("TweenService") 
    local RunService = game:GetService("RunService")
    local library = { 
        WindowState = { Opened = 1, Minimized = 0, Destroyed = -1 } 
    } 
    local Font = Enum.Font.GothamBold 
    local Colors = { 
        White = Color3.fromRGB(255, 255, 255), 
        Black = Color3.fromRGB(0, 0, 0), 
        Red = Color3.fromRGB(255, 75, 75), 
        Gray = { 
            Stroke = Color3.fromRGB(55, 55, 65), 
            Button = Color3.fromRGB(48, 48, 56), 
            DarkButton = Color3.fromRGB(40, 40, 48), 
            Top = Color3.fromRGB(26, 26, 32), 
            FramesBack = Color3.fromRGB(30, 30, 38), 
            TogBox = Color3.fromRGB(36, 36, 44), 
            DropDownButton = Color3.new(0.235294, 0.235294, 0.235294) 
        }, 
        Gradients = { 
            Red = ColorSequence.new({ 
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 75, 75)), 
                ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 100, 100)) 
            }), 
        } 
    } 

    function autobutcolor(value, color) 
        value.MouseEnter:Connect(function() 
            TweenService:Create(value, TweenInfo.new(0.18, Enum.EasingStyle.Quint), {BackgroundColor3 = Color3.fromRGB(60, 60, 70)}):Play() 
        end) 
        value.MouseLeave:Connect(function() 
            TweenService:Create(value, TweenInfo.new(0.22, Enum.EasingStyle.Quint), {BackgroundColor3 = color}):Play() 
        end) 
    end 

    function _if(bool, func1, func2) 
        if bool then return func1 else return func2 end 
    end 

    local function CreateInstance(name, parent, props, childs) 
        local childs = childs or {} 
        local instance = Instance.new(name, parent) 
        for i, v in pairs(props) do 
            instance[i] = v 
        end 
        for _, v in pairs(childs) do 
            v.Parent = instance 
        end 
        return instance 
    end 

    function library:CreateWindow(title) 
        title = title or "Demon Hub" 
        local parent = game.CoreGui 
        local state = library.WindowState.Opened 
        local window_id = math.random(1, 400) 
        local window = {} 
        local screen = CreateInstance("ScreenGui", parent, { 
            Name = "lib_" .. window_id, 
            ZIndexBehavior = Enum.ZIndexBehavior.Sibling 
        }) 
        local destructionHooks = {} 
        function window:OnDestroy(func) 
            table.insert(destructionHooks, func) 
        end 
        function window:Destroy() 
            screen:Destroy() 
            state = library.WindowState.Destroyed 
            for _, v in pairs(destructionHooks) do 
                pcall(v) 
            end 
        end 
        function window:GetTitle() 
            return title 
        end 
        local colorChangeElements = {} 
        function window:SetAccentColor(newColor) 
            Colors.Red = newColor 
            Colors.Gradients.Red = ColorSequence.new({ 
                ColorSequenceKeypoint.new(0, newColor), 
                ColorSequenceKeypoint.new(1, Color3.fromRGB(math.min(newColor.R * 255 + 25, 255), math.min(newColor.G * 255 + 25, 255), math.min(newColor.B * 255 + 25, 255))) 
            }) 
            for _, element in pairs(colorChangeElements) do 
                if element and element.Parent then 
                    if element:IsA("ScrollingFrame") then 
                        element.ScrollBarImageColor3 = newColor 
                    elseif element:IsA("Frame") and element.Name == "SliderFill" then 
                        element.BackgroundColor3 = newColor 
                        if element:FindFirstChild("UIGradient") then 
                            element.UIGradient.Color = Colors.Gradients.Red 
                        end 
                    elseif element:IsA("UIGradient") and element.Parent.Name == "Toggle" then 
                        element.Color = Colors.Gradients.Red 
                    end 
                end 
            end 
        end 

        local mainFrame = CreateInstance("Frame", screen, { 
            Name = "MainFrame", 
            Position = UDim2.new(0.5, 0, 0.5, 0), 
            Size = UDim2.new(0, 612, 0, 412),
            AnchorPoint = Vector2.new(0.5, 0.5), 
            BackgroundTransparency = 1,
            Active = true,
            ClipsDescendants = true
        }) 
        local MIN_WINDOW_SIZE = Vector2.new(450, 350)

        -- ðŸ”§ FIXED: Proper aspect ratio handling
        local aspectRatioConstraint = CreateInstance("UIAspectRatioConstraint", mainFrame, { 
            AspectRatio = 612 / 412,
            AspectType = Enum.AspectType.FitWithinMaxSize,
            DominantAxis = Enum.DominantAxis.Width
        })

        local top = CreateInstance("Frame", mainFrame, { 
            Name = "Top", 
            Size = UDim2.new(1, 0, 0, 42), 
            BackgroundColor3 = Colors.Gray.Top, 
        }) 
        CreateInstance("UICorner", top, { CornerRadius = UDim.new(0, 5) }) 
        CreateInstance("TextLabel", top, { 
            TextColor3 = Colors.White, 
            BorderColor3 = Colors.Gray.Stroke, 
            Text = title, 
            Font = Font, 
            BackgroundTransparency = 1, 
            Size = UDim2.new(1, -120, 1, 0), 
            Position = UDim2.new(0, 15, 0, 0), 
            TextSize = 14, 
            TextXAlignment = Enum.TextXAlignment.Left 
        }) 

        local closeButton = CreateInstance("TextButton", top, { 
            Text = "X", 
            Font = Font, 
            TextSize = 14, 
            TextColor3 = Colors.White, 
            Name = "close", 
            Position = UDim2.new(1, -35, 0.5, -12), 
            BackgroundColor3 = Color3.fromRGB(40, 40, 48), 
            Size = UDim2.new(0, 24, 0, 24), 
            AutoButtonColor = false 
        }) 
        CreateInstance("UICorner", closeButton, { CornerRadius = UDim.new(0, 4) }) 
        autobutcolor(closeButton, Color3.fromRGB(40, 40, 48)) 
        closeButton.MouseButton1Click:Connect(window.Destroy) 

        local maximizeButton = CreateInstance("TextButton", top, { 
            Text = "â–¡", 
            Font = Font, 
            TextSize = 14, 
            TextColor3 = Colors.White, 
            Name = "maximize", 
            Position = UDim2.new(1, -65, 0.5, -12), 
            BackgroundColor3 = Color3.fromRGB(40, 40, 48), 
            Size = UDim2.new(0, 24, 0, 24), 
            AutoButtonColor = false 
        }) 
        CreateInstance("UICorner", maximizeButton, { CornerRadius = UDim.new(0, 4) }) 
        autobutcolor(maximizeButton, Color3.fromRGB(40, 40, 48)) 
        
        local isMaximized = false 
        local normalSize, normalPos
        maximizeButton.MouseButton1Click:Connect(function() 
            isMaximized = not isMaximized 
            if isMaximized then 
                normalSize = mainFrame.Size 
                normalPos = mainFrame.Position 
                aspectRatioConstraint.AspectType = Enum.AspectType.FitWithinMaxSize
                TweenService:Create(mainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), { 
                    Size = UDim2.new(0.9, 0, 0.9, 0),
                    Position = UDim2.new(0.5, 0, 0.5, 0) 
                }):Play() 
            else 
                TweenService:Create(mainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), { 
                    Size = normalSize, 
                    Position = normalPos 
                }):Play() 
            end 
        end) 

        local minimizeButton = CreateInstance("TextButton", top, { 
            Text = "-", 
            Font = Font, 
            TextSize = 18, 
            TextColor3 = Colors.White, 
            Name = "minimize", 
            Position = UDim2.new(1, -95, 0.5, -12), 
            BackgroundColor3 = Color3.fromRGB(40, 40, 48), 
            Size = UDim2.new(0, 24, 0, 24), 
            AutoButtonColor = false 
        }) 
        CreateInstance("UICorner", minimizeButton, { CornerRadius = UDim.new(0, 4) }) 
        autobutcolor(minimizeButton, Color3.fromRGB(40, 40, 48)) 

        -- âœ¨ FIXED DRAGGING
        local isDragging = false
        local dragStart = nil
        local startPos = nil
        local dragConnection = nil
        local releaseConnection = nil
        
        top.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                isDragging = true
                dragStart = UserInputService:GetMouseLocation() 
                startPos = mainFrame.Position
                
                if dragConnection then dragConnection:Disconnect() end
                if releaseConnection then releaseConnection:Disconnect() end
                
                dragConnection = UserInputService.InputChanged:Connect(function(inputObject)
                    if isDragging and (inputObject.UserInputType == Enum.UserInputType.MouseMovement or inputObject.UserInputType == Enum.UserInputType.Touch) then
                        local mousePos = UserInputService:GetMouseLocation()
                        local delta = mousePos - dragStart
                        mainFrame.Position = UDim2.new(
                            startPos.X.Scale, 
                            startPos.X.Offset + delta.X, 
                            startPos.Y.Scale, 
                            startPos.Y.Offset + delta.Y
                        )
                    end
                end)
                
                releaseConnection = UserInputService.InputEnded:Connect(function(inputObject)
                    if inputObject.UserInputType == Enum.UserInputType.MouseButton1 or inputObject.UserInputType == Enum.UserInputType.Touch then
                        isDragging = false
                        if dragConnection then 
                            dragConnection:Disconnect() 
                            dragConnection = nil
                        end
                        if releaseConnection then 
                            releaseConnection:Disconnect() 
                            releaseConnection = nil
                        end
                    end
                end)
            end
        end)

        local windowContainer = CreateInstance("Frame", mainFrame, { 
            Position = UDim2.new(0, 0, 0, 42), 
            ZIndex = 0, 
            Size = UDim2.new(1, 0, 1, -42), 
            BackgroundColor3 = Colors.Gray.Top, 
            ClipsDescendants = true 
        }) 
        CreateInstance("UICorner", windowContainer, { CornerRadius = UDim.new(0, 5) }) 

        local resizeHandle = CreateInstance("Frame", mainFrame, {
            Name = "ResizeHandle",
            Position = UDim2.new(1, -12, 1, -12),
            Size = UDim2.new(0, 12, 0, 12),
            AnchorPoint = Vector2.new(1, 1),
            BackgroundTransparency = 1,
            ZIndex = 100
        })

        local isMinimized = false
        local isResizing = false
        local resizeConnection, resizeMoveConnection
        
        -- ðŸ”§ FIXED RESIZE - No more errors!
        resizeHandle.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                isResizing = true
                local startSize = mainFrame.AbsoluteSize
                local startMousePos = UserInputService:GetMouseLocation()
                
                -- Properly disable aspect ratio during resize
                pcall(function()
                    aspectRatioConstraint.AspectType = Enum.AspectType.FitWithinMaxSize
                end)

                resizeMoveConnection = UserInputService.InputChanged:Connect(function(inputObject)
                    if isResizing and (inputObject.UserInputType == Enum.UserInputType.MouseMovement or inputObject.UserInputType == Enum.UserInputType.Touch) then
                        local currentMousePos = UserInputService:GetMouseLocation()
                        local delta = currentMousePos - startMousePos
                        local newSize = startSize + delta
                        
                        -- Clamp to minimum size
                        local finalX = math.max(newSize.X, MIN_WINDOW_SIZE.X)
                        local finalY = math.max(newSize.Y, MIN_WINDOW_SIZE.Y)
                        
                        pcall(function()
                            mainFrame.Size = UDim2.new(0, finalX, 0, finalY)
                        end)
                    end
                end)

                resizeConnection = UserInputService.InputEnded:Connect(function(inputObject)
                    if inputObject.UserInputType == Enum.UserInputType.MouseButton1 or inputObject.UserInputType == Enum.UserInputType.Touch then
                        isResizing = false
                        if resizeMoveConnection then resizeMoveConnection:Disconnect() end
                        if resizeConnection then resizeConnection:Disconnect() end
                        
                        -- Re-enable aspect ratio if not minimized
                        pcall(function()
                            if not isMinimized then
                                aspectRatioConstraint.AspectType = Enum.AspectType.FitWithinMaxSize
                            end
                        end)
                    end
                end)
            end
        end)

        local opened = true 
        function window:Hide() 
            opened, screen.Enabled = false, false 
        end 
        function window:Show() 
            opened, screen.Enabled = true, true 
        end 
        local handler = UserInputService.InputBegan:Connect(function (input) 
            if input.KeyCode == Enum.KeyCode.RightControl then
                if opened then 
                    window:Hide() 
                else 
                    window:Show() 
                end 
            end 
        end) 
        window:OnDestroy(function () 
            handler:Disconnect()
            if dragConnection then dragConnection:Disconnect() end
            if releaseConnection then releaseConnection:Disconnect() end
            if resizeMoveConnection then resizeMoveConnection:Disconnect() end
            if resizeConnection then resizeConnection:Disconnect() end
        end) 

        local windowBody = CreateInstance("ScrollingFrame", windowContainer, { 
            ScrollBarImageColor3 = Colors.Red, 
            Active = true, 
            BorderColor3 = Colors.Gray.Stroke, 
            ScrollBarThickness = 5, 
            Position = UDim2.new(0.25, 0, 0.025, 0),
            AutomaticCanvasSize = Enum.AutomaticSize.Y, 
            CanvasSize = UDim2.new(0, 0, 0, 0), 
            Size = UDim2.new(0.73, 0, 0.95, 0),
            BorderSizePixel = 0, 
            BackgroundColor3 = Colors.Gray.FramesBack,
            ScrollingEnabled = true,
            ScrollBarImageTransparency = 0
        }) 
        table.insert(colorChangeElements, windowBody) 

        local tabs = {} 
        local currentTab = 1 
        local scrollingFrameTabs = CreateInstance("ScrollingFrame", windowContainer, { 
            ScrollBarImageColor3 = Colors.Red, 
            Active = true, 
            BorderColor3 = Colors.Gray.Stroke, 
            ScrollBarThickness = 5, 
            VerticalScrollBarInset = Enum.ScrollBarInset.Always, 
            AutomaticCanvasSize = Enum.AutomaticSize.Y, 
            Name = "ScrollingFrameTabs", 
            Position = UDim2.new(0.015, 0, 0.025, 0), 
            Size = UDim2.new(0.22, 0, 0.95, 0), 
            BackgroundTransparency = 1,
            ScrollingEnabled = true
        }) 
        table.insert(colorChangeElements, scrollingFrameTabs) 
        CreateInstance("UIListLayout", scrollingFrameTabs, { 
            Padding = UDim.new(0, 6), 
            SortOrder = Enum.SortOrder.LayoutOrder, 
        }) 
        CreateInstance("UIPadding", scrollingFrameTabs, { 
            PaddingTop = UDim.new(0, 10), 
        }) 

        local lastSizeBeforeMinimize
        minimizeButton.MouseButton1Click:Connect(function() 
            isMinimized = not isMinimized 
            state = isMinimized and library.WindowState.Minimized or library.WindowState.Opened 
            windowContainer.Visible = not isMinimized 
            resizeHandle.Visible = not isMinimized
            
            pcall(function()
                if isMinimized then
                    aspectRatioConstraint.AspectType = Enum.AspectType.FitWithinMaxSize
                else
                    aspectRatioConstraint.AspectType = Enum.AspectType.FitWithinMaxSize
                end
            end)

            local targetSize
            if isMinimized then
                lastSizeBeforeMinimize = mainFrame.Size
                targetSize = UDim2.new(lastSizeBeforeMinimize.X.Scale, lastSizeBeforeMinimize.X.Offset, 0, 42)
            else
                targetSize = lastSizeBeforeMinimize or mainFrame.Size
            end
            
            TweenService:Create(mainFrame, TweenInfo.new(0.35, Enum.EasingStyle.Quint), { Size = targetSize }):Play()
        end) 

        local function changeTab(id) 
            currentTab = id 
            for tabId, tabContainer in ipairs(tabs) do 
                tabContainer.Visible = (tabId == currentTab) 
            end 
            for _, button in ipairs(scrollingFrameTabs:GetChildren()) do 
                if button:IsA("TextButton") then 
                    local isSelected = (button.Name == "Tab" .. id) 
                    TweenService:Create(button, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
                        TextColor3 = _if(isSelected, Colors.White, Color3.fromRGB(173, 173, 173))
                    }):Play()
                end 
            end 
        end 

        function window:CreateTab(name) 
            local tab = {} 
            local tabId = #tabs + 1 
            local tabContainer = CreateInstance("Frame", windowBody, { 
                Visible = (tabId == 1), 
                Size = UDim2.new(1, 0, 0, 0), 
                AutomaticSize = Enum.AutomaticSize.Y, 
                BackgroundTransparency = 1, 
                Name = "Tab" .. tabId, 
            }) 
            table.insert(tabs, tabContainer) 
            CreateInstance("UIPadding", tabContainer, { 
                PaddingTop = UDim.new(0, 10),
                PaddingLeft = UDim.new(0, 10),
                PaddingRight = UDim.new(0, 10)
            }) 
            CreateInstance("UIListLayout", tabContainer, { 
                Padding = UDim.new(0, 7), 
                SortOrder = Enum.SortOrder.LayoutOrder 
            }) 

            local tabButton = CreateInstance("TextButton", scrollingFrameTabs, { 
                TextColor3 = _if(tabId == 1, Colors.White, Color3.fromRGB(173, 173, 173)), 
                Text = name, 
                Font = Font, 
                Name = "Tab" .. tabId, 
                AutoButtonColor = false, 
                Size = UDim2.new(1, 0, 0, 30), 
                TextSize = 12, 
                BackgroundColor3 = Colors.Gray.Top 
            }) 
            CreateInstance("UICorner", tabButton, { CornerRadius = UDim.new(0, 4) }) 
            autobutcolor(tabButton, Colors.Gray.Top) 
            tabButton.MouseButton1Click:Connect(function() 
                changeTab(tabId) 
            end) 
            
            function tab:CreateTextbox(label, callback, placeholder) 
                local callback = callback or function (_) end; 
                local placeholder = placeholder or "Write Here" 
                local textbox = {} 
                local textBoxLabel = CreateInstance("TextLabel", tabContainer, { 
                    TextColor3 = Colors.White, 
                    Text = " " .. label, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    Font = Font, 
                    Size = UDim2.new(1, 0, 0, 35), 
                    ZIndex = 0, 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                local textBoxInstance = CreateInstance("TextBox", textBoxLabel, { 
                    TextWrapped = true, 
                    TextColor3 = Color3.new(0.698039, 0.698039, 0.698039), 
                    BorderColor3 = Colors.Gray.Stroke, 
                    Text = "", 
                    AnchorPoint = Vector2.new(1, 0.5), 
                    Font = Font, 
                    Position = UDim2.new(1, -5, 0.5, 0), 
                    Size = UDim2.new(0, 85, 0, 27), 
                    PlaceholderText = placeholder, 
                    TextSize = 12, 
                    BackgroundColor3 = Colors.Gray.TogBox, 
                    ClearTextOnFocus = false, 
                }) 
                CreateInstance("UICorner", textBoxInstance, { CornerRadius = UDim.new(0,4) }) 
                CreateInstance("UICorner", textBoxLabel, { CornerRadius = UDim.new(0, 4) }) 
                textBoxInstance.FocusLost:Connect(function (enter) 
                    if enter then 
                        callback(textBoxInstance.Text, textbox) 
                    end 
                end) 
                return textbox 
            end 

            function tab:CreateSlider(label, minvalue, maxvalue, default, callback, options)
                options = options or {}
                minvalue, maxvalue, default, callback = minvalue or 0, maxvalue or 100, default or minvalue, callback or function() end 
                local supportFloats = options.floats and (type(options.floats) == "number" and options.floats or 2)
                local hasTextbox = options.textbox or false
                
                local slider = {} 
                local container = CreateInstance("TextLabel", tabContainer, { 
                    TextColor3 = Colors.White, 
                    Text = " " .. label, 
                    Size = UDim2.new(1, 0, 0, 35), 
                    Font = Font, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    TextYAlignment = Enum.TextYAlignment.Top, 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                CreateInstance("UICorner", container, { CornerRadius = UDim.new(0, 4) }) 
                CreateInstance("UIPadding", container, { 
                    PaddingBottom = UDim.new(0, 10), 
                    PaddingTop = UDim.new(0, 3) 
                }) 
                
                local valueDisplay
                if hasTextbox then
                    valueDisplay = CreateInstance("TextBox", container, {
                        BackgroundColor3 = Colors.Gray.TogBox,
                        Position = UDim2.new(1, -105, 0.25, -10),
                        Size = UDim2.new(0, 100, 0, 20),
                        Font = Enum.Font.GothamBold,
                        Text = tostring(default),
                        TextColor3 = Colors.White,
                        TextSize = 12,
                        ClearTextOnFocus = false
                    })
                    CreateInstance("UICorner", valueDisplay, {CornerRadius = UDim.new(0, 4)})
                else
                     valueDisplay = CreateInstance("TextLabel", container, { 
                        BackgroundTransparency = 1, 
                        Position = UDim2.new(1, -180, 0.25, 0),
                        Size = UDim2.new(0, 175, 0, 8), 
                        Font = Enum.Font.GothamBold, 
                        Text = tostring(default), 
                        TextColor3 = Colors.White, 
                        TextSize = 12, 
                        TextXAlignment = Enum.TextXAlignment.Right 
                    })
                end

                local sliderBack = CreateInstance("Frame", container, { 
                    BackgroundColor3 = Colors.Gray.TogBox, 
                    Position = UDim2.new(0.02, 0, 0.870, 0), 
                    Size = UDim2.new(0.96, 0, 0, 8) 
                }) 
                CreateInstance("UICorner", sliderBack, { CornerRadius = UDim.new(1, 0) }) 
                local percentage = math.clamp((default - minvalue) / (maxvalue - minvalue), 0, 1) 
                local sliderFill = CreateInstance("Frame" , sliderBack, { 
                    Name = "SliderFill", 
                    BackgroundColor3 = Colors.Red, 
                    Size = UDim2.new(percentage, 0, 1, 0) 
                }) 
                CreateInstance("UICorner", sliderFill, { CornerRadius = UDim.new(1, 0) }) 
                CreateInstance("UIGradient", sliderFill, { Color = Colors.Gradients.Red }) 
                table.insert(colorChangeElements, sliderFill) 

                local function setValue(value)
                    value = math.clamp(value, minvalue, maxvalue)
                    if supportFloats then
                        value = math.floor(value * 10^supportFloats) / 10^supportFloats
                    else
                        value = math.floor(value + 0.5)
                    end
                    local newPercent = (value - minvalue) / (maxvalue - minvalue)
                    TweenService:Create(sliderFill, TweenInfo.new(0.1, Enum.EasingStyle.Quint), {
                        Size = UDim2.new(newPercent, 0, 1, 0)
                    }):Play()
                    valueDisplay.Text = tostring(value)
                    pcall(callback, value)
                end

                if hasTextbox then
                    valueDisplay.FocusLost:Connect(function(enter)
                        if enter then
                           local num = tonumber(valueDisplay.Text)
                           if num then setValue(num) else valueDisplay.Text = tostring(default) end
                        end
                    end)
                end

                local isSliding = false
                local dragConnection, moveConnection
                
                sliderBack.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                        isSliding = true
                        local percent = math.clamp((input.Position.X - sliderBack.AbsolutePosition.X) / sliderBack.AbsoluteSize.X, 0, 1)
                        local value = minvalue + (maxvalue - minvalue) * percent
                        setValue(value)

                        moveConnection = UserInputService.InputChanged:Connect(function(inputObject)
                            if isSliding and (inputObject.UserInputType == Enum.UserInputType.MouseMovement or inputObject.UserInputType == Enum.UserInputType.Touch) then
                                local mousePos = UserInputService:GetMouseLocation()
                                local percent = math.clamp((mousePos.X - sliderBack.AbsolutePosition.X) / sliderBack.AbsoluteSize.X, 0, 1)
                                local value = minvalue + (maxvalue - minvalue) * percent
                                setValue(value)
                            end
                        end)

                        dragConnection = UserInputService.InputEnded:Connect(function(inputObject)
                             if inputObject.UserInputType == Enum.UserInputType.MouseButton1 or inputObject.UserInputType == Enum.UserInputType.Touch then
                                isSliding = false
                                if moveConnection then moveConnection:Disconnect() end
                                if dragConnection then dragConnection:Disconnect() end
                            end
                        end)
                    end
                end)
                return slider 
            end 

            function tab:CreateToggle(label, default, callback) 
                default = default or false; callback = callback or function () end 
                local toggle = {} 
                local mainToggleContainer = CreateInstance("TextButton", tabContainer, { 
                    Font = Font, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    TextColor3 = Colors.White, 
                    AutoButtonColor = false, 
                    Size = UDim2.new(1, 0, 0, 35), 
                    Text = " " .. label, 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                CreateInstance("UICorner", mainToggleContainer, { CornerRadius = UDim.new(0, 4) }) 
                local toggleTrack = CreateInstance("Frame", mainToggleContainer, { 
                    Name = "Toggle", 
                    Position = UDim2.new(1, -10, 0.5, 0), 
                    AnchorPoint = Vector2.new(1, 0.5), 
                    ZIndex = 2, 
                    Size = UDim2.new(0, 44, 0, 22), 
                    BackgroundColor3 = default and Colors.Red or Color3.fromRGB(120, 120, 128), 
                    BorderSizePixel = 0 
                }) 
                CreateInstance("UIGradient", toggleTrack, { Color = _if(default, Colors.Gradients.Red, ColorSequence.new(Color3.fromRGB(120,120,128)))})
                table.insert(colorChangeElements, toggleTrack:FindFirstChildOfClass("UIGradient"))
                CreateInstance("UICorner", toggleTrack, { CornerRadius = UDim.new(1, 0) }) 
                local toggleThumb = CreateInstance("Frame", toggleTrack, { 
                    Size = UDim2.new(0, 18, 0, 18), 
                    Position = default and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0), 
                    AnchorPoint = Vector2.new(0, 0.5), 
                    BackgroundColor3 = Color3.fromRGB(255, 255, 255), 
                    BorderSizePixel = 0, 
                    ZIndex = 3 
                }) 
                CreateInstance("UICorner", toggleThumb, { CornerRadius = UDim.new(1, 0) }) 
                CreateInstance("UIStroke", toggleThumb, { Color = Color3.fromRGB(0, 0, 0), Transparency = 0.9, Thickness = 1 }) 
                autobutcolor(mainToggleContainer, Colors.Gray.DarkButton) 
                local boolValue = CreateInstance("BoolValue", mainToggleContainer, { 
                    Name = "State", 
                    Value = default 
                }) 
                mainToggleContainer.MouseButton1Click:Connect(function () 
                    boolValue.Value = not boolValue.Value 
                    local targetColor = boolValue.Value and Colors.Red or Color3.fromRGB(120, 120, 128) 
                    local targetGradient = boolValue.Value and Colors.Gradients.Red or ColorSequence.new(Color3.fromRGB(120,120,128))
                    local targetPos = boolValue.Value and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0) 
                    
                    TweenService:Create(toggleTrack, TweenInfo.new(0.25, Enum.EasingStyle.Quint), { BackgroundColor3 = targetColor }):Play() 
                    toggleTrack.UIGradient.Color = targetGradient
                    TweenService:Create(toggleThumb, TweenInfo.new(0.25, Enum.EasingStyle.Quint), { Position = targetPos }):Play() 
                    callback(boolValue.Value, toggle) 
                end) 
                return toggle 
            end 

            function tab:CreateLabel(title, description) 
                local textLabel = CreateInstance("TextLabel", tabContainer, { 
                    TextWrapped = true, 
                    TextColor3 = Colors.White, 
                    Text = " " .. (title or ""), 
                    TextYAlignment = Enum.TextYAlignment.Top, 
                    Font = Font, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    Size = UDim2.new(1, 0, 0, (description and #description > 0) and 50 or 35), 
                    ZIndex = 0, 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                CreateInstance("UICorner", textLabel, { CornerRadius = UDim.new(0, 4) }) 
                if description and #description > 0 then 
                    CreateInstance("TextLabel", textLabel, { 
                        TextColor3 = Color3.fromRGB(200,200,200), 
                        Text = " " .. description, 
                        Font = Enum.Font.Gotham, 
                        BackgroundTransparency = 1, 
                        Position = UDim2.new(0, 0, 0.45, 0), 
                        TextXAlignment = Enum.TextXAlignment.Left, 
                        Size = UDim2.new(1, -10, 0, 26), 
                        TextSize = 12 
                    }) 
                end 
                return {} 
            end 
            
            function tab:CreateSeparator()
                CreateInstance("Frame", tabContainer, {
                    Size = UDim2.new(1, 0, 0, 1),
                    BackgroundColor3 = Colors.Gray.Stroke,
                    BorderSizePixel = 0
                })
            end

            function tab:CreateButton(name, callback) 
                local buttonContainer = CreateInstance("TextButton", tabContainer, { 
                    TextColor3 = Colors.White, 
                    Text = " " .. name, 
                    Font = Font, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    AutoButtonColor = false, 
                    Size = UDim2.new(1, 0, 0, 35), 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                CreateInstance("UICorner", buttonContainer, { CornerRadius = UDim.new(0, 4) }) 
                autobutcolor(buttonContainer, Colors.Gray.DarkButton) 
                buttonContainer.MouseButton1Click:Connect(function() 
                    callback() 
                end) 
                return {} 
            end 

            function tab:CreateDropdown(text, values, callback) 
                values, callback = values or {}, callback or function() end 
                local dropdown = {} 
                local dropdownContainer = CreateInstance("Frame", tabContainer, { 
                    Size = UDim2.new(1, 0, 0, 35), 
                    BackgroundTransparency = 1, 
                    ClipsDescendants = true 
                }) 
                local dropdownLabel = CreateInstance("TextButton", dropdownContainer, { 
                    TextColor3 = Colors.White, 
                    Text = " " .. text, 
                    Font = Font, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    AutoButtonColor = false, 
                    Size = UDim2.new(1, 0, 0, 35), 
                    ZIndex = 3, 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                CreateInstance("UICorner", dropdownLabel, { CornerRadius = UDim.new(0, 4) }) 
                autobutcolor(dropdownLabel, Colors.Gray.DarkButton) 
                local dropdownArrow = CreateInstance("TextLabel", dropdownLabel, { 
                    Text = "â–¼", 
                    TextColor3 = Colors.White, 
                    Font = Font, 
                    TextSize = 12, 
                    BackgroundTransparency = 1, 
                    Position = UDim2.new(1, -20, 0.5, -6), 
                    Size = UDim2.new(0, 15, 0, 15), 
                    ZIndex = 4 
                }) 
                local dropdownSelectedLabel = CreateInstance("TextLabel", dropdownLabel, { 
                    TextWrapped = true, 
                    TextColor3 = Colors.White, 
                    Text = "", 
                    Font = Font, 
                    BackgroundTransparency = 1, 
                    Position = UDim2.new(0.5, 0, 0, 0), 
                    Size = UDim2.new(0.5, -30, 1, 0), 
                    TextSize = 12, 
                    TextXAlignment = Enum.TextXAlignment.Right 
                }) 
                local dropdownValuesContainer = CreateInstance("ScrollingFrame", dropdownContainer, { 
                    ScrollBarImageColor3 = Colors.Red, 
                    Active = true, 
                    ScrollBarThickness = 5, 
                    BackgroundColor3 = Colors.Gray.DarkButton, 
                    Position = UDim2.new(0, 0, 0, 40), 
                    Visible = false, 
                    Size = UDim2.new(1, 0, 0, 100), 
                    AutomaticCanvasSize = Enum.AutomaticSize.Y, 
                    ZIndex = 4, 
                    BorderSizePixel = 0, 
                    CanvasSize = UDim2.new(0, 0, 0, 0) 
                }) 
                CreateInstance("UICorner", dropdownValuesContainer, { CornerRadius = UDim.new(0, 4) }) 
                CreateInstance("UIListLayout", dropdownValuesContainer, { 
                    Padding = UDim.new(0, 4), 
                    SortOrder = Enum.SortOrder.LayoutOrder 
                }) 
                CreateInstance("UIPadding", dropdownValuesContainer, { 
                    PaddingLeft = UDim.new(0, 8), 
                    PaddingRight = UDim.new(0, 8), 
                    PaddingTop = UDim.new(0, 8), 
                    PaddingBottom = UDim.new(0, 8) 
                }) 
                table.insert(colorChangeElements, dropdownValuesContainer) 

                local isOpen = false 
                local function toggleDropdown() 
                    isOpen = not isOpen 
                    dropdownContainer:SetAttribute("IsOpen", isOpen)
                    dropdownValuesContainer.Visible = isOpen 
                    local targetSize = isOpen and UDim2.new(1, 0, 0, 145) or UDim2.new(1, 0, 0, 35) 
                    dropdownContainer.Size = targetSize
                    TweenService:Create(dropdownArrow, TweenInfo.new(0.25, Enum.EasingStyle.Quint), { Rotation = isOpen and 180 or 0 }):Play() 
                end 
                dropdownLabel.MouseButton1Click:Connect(toggleDropdown) 

                local function addDropButton(value) 
                    local btn = CreateInstance("TextButton", dropdownValuesContainer, { 
                        TextSize = 14, 
                        Font = Font, 
                        TextColor3 = Colors.White, 
                        Size = UDim2.new(1, 0, 0, 28), 
                        AutoButtonColor = false, 
                        Text = " " .. value, 
                        TextXAlignment = Enum.TextXAlignment.Left, 
                        BackgroundColor3 = Colors.Gray.DropDownButton 
                    }, { 
                        CreateInstance("UICorner", nil, {CornerRadius = UDim.new(0, 4)}) 
                    }) 
                    autobutcolor(btn, Colors.Gray.DropDownButton) 
                    btn.MouseButton1Click:Connect(function() 
                        toggleDropdown()
                        dropdownSelectedLabel.Text = value 
                        callback(value, dropdown) 
                    end) 
                end 

                function dropdown:SetOptions(newValues) 
                    newValues = newValues or {} 
                    for _, child in ipairs(dropdownValuesContainer:GetChildren()) do 
                        if child:IsA("TextButton") then 
                            child:Destroy() 
                        end 
                    end 
                    local currentSelection = dropdownSelectedLabel.Text 
                    local selectionStillExists = false 
                    for _, v in ipairs(newValues) do 
                        if v == currentSelection then 
                            selectionStillExists = true 
                            break 
                        end 
                    end 
                    if not selectionStillExists then 
                        dropdownSelectedLabel.Text = "" 
                        pcall(callback, nil, dropdown) 
                    end 
                    for _, v in ipairs(newValues) do 
                        addDropButton(v) 
                    end 
                end 

                for _, v in ipairs(values) do 
                    addDropButton(v) 
                end 
                return dropdown 
            end 

            function tab:CreatePlayerDropdown(text, callback) 
                local function getPlayerNames() 
                    local players = game.Players:GetPlayers() 
                    local names = {} 
                    for _, player in ipairs(players) do 
                        table.insert(names, player.Name) 
                    end 
                    table.sort(names) 
                    return names 
                end 

                local dropdown = tab:CreateDropdown(text, getPlayerNames(), callback) 

                local function updateDropdown() 
                    dropdown:SetOptions(getPlayerNames()) 
                end 

                local playerAddedConn = game.Players.PlayerAdded:Connect(updateDropdown) 
                local playerRemovingConn = game.Players.PlayerRemoving:Connect(updateDropdown) 

                window:OnDestroy(function() 
                    playerAddedConn:Disconnect() 
                    playerRemovingConn:Disconnect() 
                end) 

                return dropdown 
            end 
            
            function tab:CreateKeybind(label, defaultKey, callback)
                defaultKey = defaultKey or "..."
                callback = callback or function() end
                
                local keybind = {}
                local currentKey = defaultKey
                local isSettingKey = false
                
                local container = CreateInstance("TextLabel", tabContainer, {
                    TextColor3 = Colors.White,
                    Text = " " .. label,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    Font = Font,
                    Size = UDim2.new(1, 0, 0, 35),
                    TextSize = 14,
                    BackgroundColor3 = Colors.Gray.DarkButton
                })
                CreateInstance("UICorner", container, {CornerRadius = UDim.new(0, 4)})

                local keyButton = CreateInstance("TextButton", container, {
                    Text = currentKey,
                    AnchorPoint = Vector2.new(1, 0.5),
                    Position = UDim2.new(1, -5, 0.5, 0),
                    Size = UDim2.new(0, 85, 0, 27),
                    Font = Font,
                    TextSize = 12,
                    TextColor3 = Colors.White,
                    BackgroundColor3 = Colors.Gray.TogBox,
                    AutoButtonColor = false
                })
                CreateInstance("UICorner", keyButton, {CornerRadius = UDim.new(0, 4)})
                autobutcolor(keyButton, Colors.Gray.TogBox)

                keyButton.MouseButton1Click:Connect(function()
                    isSettingKey = true
                    keyButton.Text = "..."
                end)
                
                keyButton.MouseButton2Click:Connect(function()
                    isSettingKey = false
                    currentKey = "..."
                    keyButton.Text = currentKey
                end)

                local keypressConnection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                    if not gameProcessed then
                        if isSettingKey then
                            currentKey = input.KeyCode.Name
                            keyButton.Text = currentKey
                            isSettingKey = false
                        elseif input.KeyCode.Name == currentKey and currentKey ~= "..." then
                            pcall(callback)
                        end
                    end
                end)
                
                window:OnDestroy(function() keypressConnection:Disconnect() end)
                
                return keybind
            end

            -- ðŸŽ¨ EXPANDED COLOR PICKER with 24 colors!
            function tab:CreateColorPicker(label, defaultColor, callback) 
                callback = callback or function() end 
                local colorPicker = {} 
                local container = CreateInstance("TextButton", tabContainer, { 
                    TextColor3 = Colors.White, 
                    Text = " " .. label, 
                    Font = Font, 
                    TextXAlignment = Enum.TextXAlignment.Left, 
                    AutoButtonColor = false, 
                    Size = UDim2.new(1, 0, 0, 35), 
                    TextSize = 14, 
                    BackgroundColor3 = Colors.Gray.DarkButton 
                }) 
                CreateInstance("UICorner", container, { CornerRadius = UDim.new(0, 4) }) 
                autobutcolor(container, Colors.Gray.DarkButton) 
                local colorDisplay = CreateInstance("Frame", container, { 
                    Size = UDim2.new(0, 30, 0, 20), 
                    Position = UDim2.new(1, -40, 0.5, -10), 
                    BackgroundColor3 = defaultColor or Colors.Red, 
                    BorderSizePixel = 0 
                }) 
                CreateInstance("UICorner", colorDisplay, { CornerRadius = UDim.new(0, 4) }) 
                CreateInstance("UIStroke", colorDisplay, { Color = Color3.fromRGB(60, 60, 70), Thickness = 1 }) 

                -- ðŸŽ¨ 24 AMAZING COLORS!
                local colorPalette = { 
                    -- Reds & Pinks
                    Color3.fromRGB(255, 75, 75),   -- Red
                    Color3.fromRGB(255, 100, 200), -- Pink
                    Color3.fromRGB(200, 50, 100),  -- Dark Pink
                    
                    -- Oranges & Yellows
                    Color3.fromRGB(255, 150, 50),  -- Orange
                    Color3.fromRGB(255, 200, 80),  -- Light Orange
                    Color3.fromRGB(255, 220, 50),  -- Yellow
                    
                    -- Greens
                    Color3.fromRGB(100, 255, 100), -- Green
                    Color3.fromRGB(50, 200, 100),  -- Mint
                    Color3.fromRGB(100, 255, 180), -- Aqua Green
                    
                    -- Cyans & Blues
                    Color3.fromRGB(50, 200, 255),  -- Cyan
                    Color3.fromRGB(80, 150, 255),  -- Sky Blue
                    Color3.fromRGB(100, 100, 255), -- Blue
                    
                    -- Purples
                    Color3.fromRGB(150, 100, 255), -- Purple
                    Color3.fromRGB(200, 100, 255), -- Light Purple
                    Color3.fromRGB(180, 80, 200),  -- Violet
                    
                    -- Neutrals & Special
                    Color3.fromRGB(255, 255, 255), -- White
                    Color3.fromRGB(200, 200, 200), -- Light Gray
                    Color3.fromRGB(120, 120, 130), -- Gray
                    Color3.fromRGB(80, 80, 90),    -- Dark Gray
                    Color3.fromRGB(40, 40, 50),    -- Darker Gray
                    
                    -- Extra vibrant colors
                    Color3.fromRGB(255, 50, 150),  -- Hot Pink
                    Color3.fromRGB(150, 255, 50),  -- Lime
                    Color3.fromRGB(50, 255, 255),  -- Bright Cyan
                    Color3.fromRGB(255, 100, 50),  -- Coral
                } 

                local paletteFrame = CreateInstance("Frame", tabContainer, { 
                    Size = UDim2.new(1, 0, 0, 0), 
                    BackgroundColor3 = Colors.Gray.DarkButton, 
                    Visible = false, 
                    ClipsDescendants = true 
                }) 
                CreateInstance("UICorner", paletteFrame, { CornerRadius = UDim.new(0, 4) }) 

                local paletteGrid = CreateInstance("Frame", paletteFrame, { 
                    Size = UDim2.new(1, -20, 1, -20), 
                    Position = UDim2.new(0, 10, 0, 10), 
                    BackgroundTransparency = 1 
                }) 
                CreateInstance("UIGridLayout", paletteGrid, { 
                    CellSize = UDim2.new(0, 38, 0, 33), 
                    CellPadding = UDim2.new(0, 4, 0, 4), 
                    SortOrder = Enum.SortOrder.LayoutOrder 
                }) 

                for i, color in ipairs(colorPalette) do 
                    local colorBtn = CreateInstance("TextButton", paletteGrid, { 
                        Text = "", 
                        BackgroundColor3 = color, 
                        AutoButtonColor = false, 
                        Size = UDim2.new(0, 38, 0, 33) 
                    }) 
                    CreateInstance("UICorner", colorBtn, { CornerRadius = UDim.new(0, 4) }) 
                    CreateInstance("UIStroke", colorBtn, { Color = Color3.fromRGB(60, 60, 70), Thickness = 2 }) 
                    
                    -- Hover effect
                    colorBtn.MouseEnter:Connect(function()
                        TweenService:Create(colorBtn.UIStroke, TweenInfo.new(0.15), {Thickness = 3, Color = Colors.White}):Play()
                    end)
                    colorBtn.MouseLeave:Connect(function()
                        TweenService:Create(colorBtn.UIStroke, TweenInfo.new(0.15), {Thickness = 2, Color = Color3.fromRGB(60, 60, 70)}):Play()
                    end)
                    
                    colorBtn.MouseButton1Click:Connect(function() 
                        colorDisplay.BackgroundColor3 = color 
                        window:SetAccentColor(color) 
                        callback(color) 
                        paletteFrame.Visible = false 
                        TweenService:Create(paletteFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {Size = UDim2.new(1, 0, 0, 0)}):Play() 
                    end) 
                end 

                local isOpen = false 
                container.MouseButton1Click:Connect(function() 
                    isOpen = not isOpen 
                    paletteFrame.Visible = isOpen 
                    local targetSize = isOpen and UDim2.new(1, 0, 0, 155) or UDim2.new(1, 0, 0, 0) 
                    TweenService:Create(paletteFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {Size = targetSize}):Play() 
                end) 
                return colorPicker 
            end 

            return tab 
        end 
        return window 
    end 
    return library 
end)() 
return library
